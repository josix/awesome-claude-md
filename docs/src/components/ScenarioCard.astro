---
interface Props {
  id: string;
  title: string;
  owner: string;
  repo: string;
  category: string;
  languages: string[];
  takeaways: string[];
  sourceUrl: string;
}

const { id, title, owner, repo, category, languages, takeaways, sourceUrl } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;

const categoryColors: Record<string, string> = {
  "complex-projects": "bg-purple-100 text-purple-800",
  "developer-tooling": "bg-blue-100 text-blue-800",
  "libraries-frameworks": "bg-green-100 text-green-800",
  "getting-started": "bg-yellow-100 text-yellow-800",
  "infrastructure-projects": "bg-red-100 text-red-800",
  "project-handoffs": "bg-orange-100 text-orange-800",
};

const categoryColor = categoryColors[category] || "bg-gray-100 text-gray-800";
---

<article class="card p-5 flex flex-col h-full" data-pagefind-body>
  <header class="mb-3">
    <div class="flex items-start justify-between gap-2 mb-2">
      <h3 class="text-lg font-semibold text-gray-900 leading-tight">
        <a href={`${baseUrl}scenarios/${id}/`} class="hover:text-primary-600 transition-colors">
          {owner}/{repo}
        </a>
      </h3>
      <a
        href={sourceUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors"
        title="View original CLAUDE.md"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
        </svg>
      </a>
    </div>

    <div class="flex flex-wrap gap-2">
      <span class={`badge ${categoryColor}`} data-category={category}>
        {category.replace(/-/g, " ")}
      </span>
      {languages.slice(0, 3).map((lang) => (
        <span class="badge badge-language" data-language={lang}>{lang}</span>
      ))}
    </div>
  </header>

  {takeaways.length > 0 && (
    <ul class="flex-1 space-y-1.5 text-sm text-gray-600 mb-4">
      {takeaways.slice(0, 3).map((takeaway) => (
        <li class="flex items-start gap-2">
          <svg class="w-4 h-4 text-primary-500 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          <span class="line-clamp-2">{takeaway}</span>
        </li>
      ))}
    </ul>
  )}

  <footer class="mt-auto pt-3 border-t border-gray-100">
    <a
      href={`${baseUrl}scenarios/${id}/`}
      class="text-sm font-medium text-primary-600 hover:text-primary-700 transition-colors inline-flex items-center gap-1"
    >
      View details
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </a>
  </footer>
</article>
